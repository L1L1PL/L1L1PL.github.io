<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>–¢–∞–π–Ω—ã–π –°–∞–Ω—Ç–∞ üéÖ</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: url('https://all-vector.ru/files/img/2/01571.jpg') no-repeat center center fixed;
  background-size: cover;
  color: #111;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 40px 16px;
  position: relative;
  min-height: 100vh;
}
h1 { color: #fff; text-shadow: 2px 2px 8px #000; }
.card {
  background: rgba(255,255,255,0.95);
  padding: 28px;
  border-radius: 16px;
  max-width: 400px;
  width: 100%;
  text-align: center;
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
  position: relative;
  z-index: 1;
}
input, button { padding: 12px; font-size: 16px; margin: 8px 0; width: 80%; border-radius: 8px; }
button { cursor: pointer; background: #2563eb; color: #fff; border:none; }
button:hover { background: #1d4ed8; }
.result { margin-top: 20px; font-weight: 600; color: #065f46; }
.error { color: #b91c1c; margin-top: 10px; }
.decor {
  position: absolute;
  pointer-events: none;
  z-index: 0;
  animation: float 20s linear infinite;
}
.decor:nth-child(1){top:10%; left:5%; width:80px;}
.decor:nth-child(2){top:30%; right:10%; width:100px; animation-duration:25s;}
.decor:nth-child(3){bottom:15%; left:15%; width:60px; animation-duration:22s;}
@keyframes float {0%{transform:translateY(0);}50%{transform:translateY(-15px);}100%{transform:translateY(0);}}
</style>
</head>
<body>
<img src="https://cdn-icons-png.flaticon.com/512/616/616408.png" class="decor" alt="–°–∞–Ω—Ç–∞">
<img src="https://cdn-icons-png.flaticon.com/512/616/616442.png" class="decor" alt="–û–ª–µ–Ω—å">
<img src="https://cdn-icons-png.flaticon.com/512/616/616454.png" class="decor" alt="–û–ª–µ–Ω—å">

<h1>üéÖ –¢–∞–π–Ω—ã–π –°–∞–Ω—Ç–∞</h1>
<div class="card">
  <input id="nameInput" placeholder="–í–∞—à–µ –∏–º—è">
  <button id="showBtn">–£–∑–Ω–∞—Ç—å –ø–æ–ª—É—á–∞—Ç–µ–ª—è üéÅ</button>
  <button id="resetBtn">–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∂–µ—Ä–µ–±—å—ë–≤–∫—É (–ê–¥–º–∏–Ω)</button>
  <div id="message" class="error"></div>
  <div id="result" class="result"></div>
</div>

<script>
const API_URL = '/api/secretSanta';
const names = ['–ú–∏—à–∞','–ù–∞—Å—Ç—è','–ö–∏—Ä—è','–õ–∏–∑–∞','–í–∏—Ç—è','–Æ–ª—è'];

function normalizeName(input){
  if(!input) return '';
  const trimmed = input.trim().toLowerCase();
  return trimmed.charAt(0).toUpperCase() + trimmed.slice(1);
}

document.getElementById('showBtn').addEventListener('click', async ()=>{
  const inputEl = document.getElementById('nameInput');
  const msg = document.getElementById('message');
  const res = document.getElementById('result');
  msg.textContent = '';
  res.textContent = '';

  const name = normalizeName(inputEl.value);
  if(!names.includes(name)){ msg.textContent='–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏–º—è'; return; }

  try{
    const response = await fetch(`${API_URL}?name=${encodeURIComponent(name)}`);
    const data = await response.json();
    if(data.error){ msg.textContent = data.error; return; }
    res.textContent = 'üéÅ –í—ã –¥–∞—Ä–∏—Ç–µ –ø–æ–¥–∞—Ä–æ–∫: ' + data.pair;
  }catch(e){ msg.textContent = '–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞'; }
});

document.getElementById('resetBtn').addEventListener('click', async ()=>{
  const code = prompt('–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞');
  if(!code) return;
  try{
    const response = await fetch(`${API_URL}?code=${encodeURIComponent(code)}`, {method:'POST'});
    const data = await response.json();
    if(data.error){ alert(data.error); return; }
    alert(data.message);
  }catch(e){ alert('–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞'); }
});
</script>
</body>
</html>
